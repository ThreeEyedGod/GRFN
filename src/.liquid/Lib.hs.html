<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Lib.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE NoImplicitPrelude #-}</span></a>
<span class=hs-linenum>  2: </span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>-- | Module for accessing this math function</span>
<span class=hs-linenum>  4: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Lib</span>
<span class=hs-linenum>  5: </span>  <span class='hs-layout'>(</span> <span class='hs-varid'>genARandomPreFactoredNumberLTEn</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  6: </span>    <span class='hs-varid'>createBasicSeq</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  7: </span>    <span class='hs-varid'>getRndMInt</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  8: </span>    <span class='hs-varid'>mkStartRndIoIntLstn1</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  9: </span>    <span class='hs-varid'>filterIndexed</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 10: </span>    <span class='hs-varid'>indexedR</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 11: </span>    <span class='hs-varid'>indexedPairs</span><span class='hs-layout'>,</span>
<span class=hs-linenum> 12: </span>    <span class='hs-varid'>makeList</span>
<span class=hs-linenum> 13: </span>  <span class='hs-layout'>)</span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>where</span>
<span class=hs-linenum> 15: </span>
<span class=hs-linenum> 16: </span><span class='hs-comment'>-- import Data.Bool (bool) -- after refactoring yet again, using Data.bool.HT this is no longer being used</span>
<span class=hs-linenum> 17: </span>
<span class=hs-linenum> 18: </span><span class='hs-comment'>-- import ShortCircuit (if') -- now after refactoring using bool, this is not being used</span>
<span class=hs-linenum> 19: </span>
<span class=hs-linenum> 20: </span><span class='hs-comment'>-- disabling termination checking</span>
<span class=hs-linenum> 21: </span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Monad</span> <span class='hs-layout'>(</span><span class='hs-varid'>replicateM</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 23: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Monad.Loops</span> <span class='hs-layout'>(</span><span class='hs-varid'>unfoldWhileM</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 24: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Parallel</span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Bool.HT</span> <span class='hs-layout'>(</span><span class='hs-varid'>if'</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 26: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.List.Index</span> <span class='hs-layout'>(</span><span class='hs-varid'>indexed</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 27: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Numbers.Primes</span> <span class='hs-layout'>(</span><span class='hs-varid'>isPrime</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Text</span> <span class='hs-layout'>(</span><span class='hs-varid'>pack</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Debug.Trace</span> <span class='hs-layout'>(</span><span class='hs-varid'>trace</span><span class='hs-layout'>,</span> <span class='hs-varid'>traceM</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 30: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Protolude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>bool</span><span class='hs-layout'>,</span> <span class='hs-varid'>die</span><span class='hs-layout'>,</span> <span class='hs-varid'>head</span><span class='hs-layout'>,</span> <span class='hs-varid'>trace</span><span class='hs-layout'>,</span> <span class='hs-varid'>traceM</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>RefinementHelper</span>
<span class=hs-linenum> 32: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>System.Random.Stateful</span> <span class='hs-layout'>(</span><span class='hs-varid'>globalStdGen</span><span class='hs-layout'>,</span> <span class='hs-varid'>randomRIO</span><span class='hs-layout'>,</span> <span class='hs-varid'>uniformRM</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 33: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-layout'>(</span><span class='hs-varid'>head</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>!!</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>tail</span><span class='hs-layout'>,</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 34: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Ix</span> <span class='hs-layout'>(</span><span class='hs-varid'>inRange</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 35: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Semigroup</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 36: </span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>lazy</span> <span class='hs-varid'>createBasicSeq</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 38: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>createBasicSeq</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>Text</span> <span class='hs-layout'>(</span><span class='hs-conid'>LstPosMaxN</span> <span class='hs-num'>1</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 39: </span><span class='hs-comment'>-- {-@ createBasicSeq :: n:Pos -&gt; IO (Either Text [Pos]) @-}</span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span><span class='hs-comment'>-- | Provided an Int, creates a sequence of random integers LTE n decreasing possibly with multiples ending at single 1</span>
<span class=hs-linenum> 42: </span><span class='hs-definition'>createBasicSeq</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 43: </span><a class=annot href="#"><span class=annottext>x1:{VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                            &amp;&amp; 0 &lt; VV##0} -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [{VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                                                                                                                                 &amp;&amp; 0 &lt; VV##0
                                                                                                                                 &amp;&amp; 1 &lt;= VV##0
                                                                                                                                 &amp;&amp; VV##0 &lt;= x1}]))</span><span class='hs-definition'>createBasicSeq</span></a> <a class=annot href="#"><span class=annottext>{VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                         &amp;&amp; 0 &lt; VV##0}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8W4
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) | isLeft v}</span><span class='hs-conid'>Left</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Invalid"</span></a>
<span class=hs-linenum> 44: </span><span class='hs-definition'>createBasicSeq</span> <span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) | not (isLeft v)}</span><span class='hs-conid'>Right</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | len v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 45: </span><span class='hs-definition'>createBasicSeq</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8W4
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 46: </span>  <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>seed</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO {v : GHC.Types.Int | v &gt;= 0
                                   &amp;&amp; 0 &lt; v})</span><span class='hs-varid'>getRndMInt</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Types.Int, GHC.Types.Int) | snd v == x##a8W4
                                      &amp;&amp; x_Tuple22 v == x##a8W4}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8W4
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>n</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 47: </span>  <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [{v : GHC.Types.Int | v &gt;= 0
                                                                  &amp;&amp; 0 &lt; v
                                                                  &amp;&amp; 1 &lt;= v
                                                                  &amp;&amp; v &lt;= seed##a8W6}])</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>x1:{VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                            &amp;&amp; 0 &lt; VV##0} -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [{VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                                                                                                                                 &amp;&amp; 0 &lt; VV##0
                                                                                                                                 &amp;&amp; 1 &lt;= VV##0
                                                                                                                                 &amp;&amp; VV##0 &lt;= x1}]))</span><span class='hs-varid'>createBasicSeq</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == seed##a8W6
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>seed</span></a>
<span class=hs-linenum> 48: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [{v : GHC.Types.Int | v &gt;= 0
                                                                       &amp;&amp; 0 &lt; v
                                                                       &amp;&amp; 1 &lt;= v
                                                                       &amp;&amp; v &lt;= seed##a8W6}]) | v == x##a8W7}</span><span class='hs-varid'>x</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 49: </span>    <span class='hs-conid'>Left</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) | isLeft v}</span><span class='hs-conid'>Left</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Invalid"</span></a>
<span class=hs-linenum> 50: </span>    <span class='hs-conid'>Right</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) | isLeft v}</span><span class='hs-conid'>Left</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Invalid"</span></a>
<span class=hs-linenum> 51: </span>    <span class='hs-conid'>Right</span> <span class='hs-varid'>nxt</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-varid'>x1</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 52: </span>      <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == seed##a8W6
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>seed</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8W4
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == seed##a8W6
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>seed</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x1##a8W9
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v
                     &amp;&amp; 1 &lt;= v
                     &amp;&amp; v &lt;= seed##a8W6}</span><span class='hs-varid'>x1</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8W4
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x1##a8W9
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v
                     &amp;&amp; 1 &lt;= v
                     &amp;&amp; v &lt;= seed##a8W6}</span><span class='hs-varid'>x1</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == seed##a8W6 - x1##a8W9}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == seed##a8W6
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>seed</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x1##a8W9
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v
                     &amp;&amp; 1 &lt;= v
                     &amp;&amp; v &lt;= seed##a8W6}</span><span class='hs-varid'>x1</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 53: </span>        <span class='hs-conid'>True</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) | not (isLeft v)}</span><span class='hs-conid'>Right</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Int] | head v == seed##a8W6}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == seed##a8W6
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>seed</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{v : [{v : GHC.Types.Int | v &gt;= 0
                           &amp;&amp; 0 &lt; v
                           &amp;&amp; 1 &lt;= v
                           &amp;&amp; v &lt;= seed##a8W6}] | len v &gt;= 0}</span><span class='hs-varid'>nxt</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 54: </span>        <span class='hs-conid'>False</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) | isLeft v}</span><span class='hs-conid'>Left</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Invalid"</span></a>
<span class=hs-linenum> 55: </span><span class='hs-definition'>createBasicSeq</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [GHC.Types.Int]) | isLeft v}</span><span class='hs-conid'>Left</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Invalid"</span></a>
<span class=hs-linenum> 56: </span>
<span class=hs-linenum> 57: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>lazy</span> <span class='hs-varid'>genARandomPreFactoredNumberLTEn</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 58: </span>
<span class=hs-linenum> 59: </span><span class='hs-comment'>-- | This is the Entry Function.</span>
<span class=hs-linenum> 60: </span><span class='hs-comment'>-- Provide an integer input and it should generate a tuple of a number less than the integer i/p and its factors</span>
<span class=hs-linenum> 61: </span><span class='hs-definition'>genARandomPreFactoredNumberLTEn</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>Text</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 62: </span><a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])))</span><span class='hs-definition'>genARandomPreFactoredNumberLTEn</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8Wa}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) | isLeft v}</span><span class='hs-conid'>Left</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Invalid"</span></a>
<span class=hs-linenum> 63: </span><span class='hs-definition'>genARandomPreFactoredNumberLTEn</span> <span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) | not (isLeft v)}</span><span class='hs-conid'>Right</span></a> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, [GHC.Types.Int])</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 64: </span><span class='hs-definition'>genARandomPreFactoredNumberLTEn</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8Wa}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 65: </span>  <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text [{v : GHC.Types.Int | v &gt;= 0
                                                                  &amp;&amp; 0 &lt; v
                                                                  &amp;&amp; 1 &lt;= v
                                                                  &amp;&amp; v &lt;= x##a8Wa}])</span><span class='hs-varid'>m</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>x1:{VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                            &amp;&amp; 0 &lt; VV##0} -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text [{VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                                                                                                                                 &amp;&amp; 0 &lt; VV##0
                                                                                                                                 &amp;&amp; 1 &lt;= VV##0
                                                                                                                                 &amp;&amp; VV##0 &lt;= x1}]))</span><span class='hs-varid'>createBasicSeq</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8Wa}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum> 66: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text [{v : GHC.Types.Int | v &gt;= 0
                                                                       &amp;&amp; 0 &lt; v
                                                                       &amp;&amp; 1 &lt;= v
                                                                       &amp;&amp; v &lt;= x##a8Wa}]) | v == m##a8Wc}</span><span class='hs-varid'>m</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 67: </span>    <span class='hs-conid'>Left</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) | isLeft v}</span><span class='hs-conid'>Left</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Invalid"</span></a>
<span class=hs-linenum> 68: </span>    <span class='hs-conid'>Right</span> <span class='hs-varid'>seqNumbers</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a . GHC.Types.Bool -&gt; a -&gt; a -&gt; a | VV == if'}</span><span class='hs-varid'>if'</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v &lt;=&gt; ps##a981 &lt;= x##a8Wa}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == ps##a981}</span><span class='hs-varid'>ps</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8Wa}</span><span class='hs-varid'>n</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])))</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) | not (isLeft v)}</span><span class='hs-conid'>Right</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Types.Int, [GHC.Types.Int]) | v == rsp##a97Y}</span><span class='hs-varid'>rsp</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])))</span><span class='hs-layout'>(</span></a><span class='hs-varid'>genARandomPreFactoredNumberLTEn</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x##a8Wa}</span><span class='hs-varid'>n</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 69: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum> 70: </span>        <a class=annot href="#"><span class=annottext>(GHC.Types.Int, [GHC.Types.Int])</span><span class='hs-varid'>rsp</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>ps</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-varid'>sq</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, [GHC.Types.Int])</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>product</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-varid'>sq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Int] | len v &lt;= len seqNumbers##a8Wd}</span><span class='hs-varid'>filter</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; GHC.Types.Bool</span><span class='hs-varid'>isPrime</span></a> <a class=annot href="#"><span class=annottext>{v : [{v : GHC.Types.Int | v &gt;= 0
                           &amp;&amp; 0 &lt; v
                           &amp;&amp; 1 &lt;= v
                           &amp;&amp; v &lt;= x##a8Wa}] | v == seqNumbers##a8Wd
                                               &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>seqNumbers</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>y</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- product [] is 1, surprising</span>
<span class=hs-linenum> 71: </span><span class='hs-definition'>genARandomPreFactoredNumberLTEn</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) -&gt; (GHC.Types.IO (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])))</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (Data.Either.Either Data.Text.Internal.Text (GHC.Types.Int, [GHC.Types.Int])) | isLeft v}</span><span class='hs-conid'>Left</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>pack</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Invalid"</span></a>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-comment'>-- helper functions</span>
<span class=hs-linenum> 74: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>getRndMInt</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>{(Pos, Pos) | fst x &lt;= snd x &amp;&amp; fst x &gt; 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-keyword'>{y:</span><span class='hs-conid'>Pos</span> <span class='hs-keyword'>| y &gt;= fst x &amp;&amp; y &lt;= snd x}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 75: </span><span class='hs-comment'>-- Get a random integer given a lower and upper bound</span>
<span class=hs-linenum> 76: </span>
<span class=hs-linenum> 77: </span><span class='hs-comment'>-- | Get a Random Integer with uniform probability in the range [1,n]</span>
<span class=hs-linenum> 78: </span><span class='hs-definition'>getRndMInt</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 79: </span><a class=annot href="#"><span class=annottext>x1:{v : ({VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                                  &amp;&amp; 0 &lt; VV##0}, {VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                                                                          &amp;&amp; 0 &lt; VV##0}) | fst v &gt; 0
                                                                                           &amp;&amp; fst v &lt;= snd v} -&gt; (GHC.Types.IO {VV##0 : GHC.Types.Int | VV##0 &gt;= 0
                                                                                                                                                        &amp;&amp; VV##0 &gt;= fst x1
                                                                                                                                                        &amp;&amp; 0 &lt; VV##0
                                                                                                                                                        &amp;&amp; VV##0 &lt;= snd x1})</span><span class='hs-definition'>getRndMInt</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == l##a8Wi
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>l</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == u##a8Wj
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>u</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == l##a8Wi
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>l</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 80: </span>  <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>result</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>uniformRM</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Types.Int, GHC.Types.Int) | fst v == l##a8Wi
                                      &amp;&amp; snd v == u##a8Wj
                                      &amp;&amp; x_Tuple21 v == l##a8Wi
                                      &amp;&amp; x_Tuple22 v == u##a8Wj}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == l##a8Wi
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == u##a8Wj
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>u</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (System.Random.Stateful.AtomicGenM System.Random.Internal.StdGen) | v == globalStdGen}</span><span class='hs-varid'>globalStdGen</span></a>
<span class=hs-linenum> 81: </span>  <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>pure</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == result##a8Wk}</span><span class='hs-varid'>result</span></a> <span class='hs-varop'>`min`</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == u##a8Wj
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>u</span></a> <span class='hs-varop'>`max`</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == l##a8Wi
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>l</span></a>
<span class=hs-linenum> 82: </span><span class='hs-definition'>getRndMInt</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : [GHC.Types.Char] | false} -&gt; a | VV == die}</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"impossible"</span></a>
<span class=hs-linenum> 83: </span>
<span class=hs-linenum> 84: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>makeList</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 85: </span><span class='hs-definition'>makeList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 86: </span><span class='hs-definition'>makeList</span> <span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pure</span> <span class='hs-conid'>[]</span>
<span class=hs-linenum> 87: </span><span class='hs-definition'>makeList</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 88: </span>  <span class='hs-varid'>seed</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getRndMInt</span> <span class='hs-layout'>(</span><span class='hs-num'>1</span><span class='hs-layout'>,</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- int becomes IO Int becomes int</span>
<span class=hs-linenum> 89: </span>  <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-varid'>seed</span> <span class='hs-conop'>:</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>makeList</span> <span class='hs-varid'>seed</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 90: </span>
<span class=hs-linenum> 91: </span>
<span class=hs-linenum> 92: </span>  <span class='hs-comment'>--liftM2 (:) (pure seed) (makeList seed)</span>
<span class=hs-linenum> 93: </span>  <span class='hs-comment'>--y &lt;- makeList seed -- int becomes io [int] becomes [int]</span>
<span class=hs-linenum> 94: </span>  <span class='hs-comment'>--pure $ seed : y  -- int : [int] becomes io [int]</span>
<span class=hs-linenum> 95: </span><span class='hs-comment'>--makeList n = getRndMInt (1,n) &gt;&gt;= \seed -&gt; makeList seed &gt;&gt;= \y -&gt; pure $ seed : y</span>
<span class=hs-linenum> 96: </span>
<span class=hs-linenum> 97: </span><span class='hs-definition'>tests</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 98: </span><a class=annot href="#"><span class=annottext>{VV##3240 : [[GHC.Types.Char]] | len $VV##3240##k_ &gt; 0
                                 &amp;&amp; len $VV##3240##k_ &gt;= 0}</span><span class='hs-definition'>tests</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"y"</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Y"</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{v : [[GHC.Types.Char]] | len $VV##3298##k_ &gt;= 0}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len $VV##3271##k_ == len $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; len $VV##3271##k_ == len $lq_anf$##7205759403792829029##d9dr##k_
                        &amp;&amp; len $VV##3271##k_ == strLen $lq_anf$##7205759403792829026##d9do##k_
                        &amp;&amp; len $VV##3271##k_ == strLen $lq_anf$##7205759403792829028##d9dq##k_
                        &amp;&amp; len $VV##3271##k_ &gt; 0
                        &amp;&amp; len $VV##3271##k_ &gt;= 0
                        &amp;&amp; len $VV##3271##k_ &gt;= len $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; len $VV##3271##k_ &gt;= len $lq_anf$##7205759403792829029##d9dr##k_
                        &amp;&amp; len v &gt;= 0
                        &amp;&amp; len $VV##3271##k_ &lt;= len $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; len $VV##3271##k_ &lt;= len $lq_anf$##7205759403792829029##d9dr##k_}</span><span class='hs-varid'>y</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | $VV##3424##k_ /= $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; $VV##3424##k_ /= $lq_anf$##7205759403792829029##d9dr##k_
                        &amp;&amp; len $VV##3424##k_ &gt;= 0
                        &amp;&amp; len v &gt;= 0
                        &amp;&amp; len $VV##3424##k_ &lt;= len $ds_d9an##k_
                        &amp;&amp; len $VV##3424##k_ &lt;= len $ds_d9ao##k_
                        &amp;&amp; len $VV##3424##k_ &lt;= len $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; len $VV##3424##k_ &lt;= len $lq_anf$##7205759403792829029##d9dr##k_
                        &amp;&amp; len $VV##3424##k_ &lt;= len $lq_anf$##7205759403792829030##d9ds##k_}</span><span class='hs-varid'>e</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len $VV##3596##k_ == len $ds_d9ao##k_
                        &amp;&amp; len $VV##3596##k_ == len $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; len $VV##3596##k_ == len $lq_anf$##7205759403792829029##d9dr##k_
                        &amp;&amp; len $VV##3596##k_ == strLen $lq_anf$##7205759403792829026##d9do##k_
                        &amp;&amp; len $VV##3596##k_ == strLen $lq_anf$##7205759403792829028##d9dq##k_
                        &amp;&amp; $VV##3596##k_ /= $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; $VV##3596##k_ /= $lq_anf$##7205759403792829029##d9dr##k_
                        &amp;&amp; len $VV##3596##k_ &gt; 0
                        &amp;&amp; len $VV##3596##k_ &gt;= 0
                        &amp;&amp; len $VV##3596##k_ &gt;= len $ds_d9ao##k_
                        &amp;&amp; len $VV##3596##k_ &gt;= len $ds_d9as##k_
                        &amp;&amp; len $VV##3596##k_ &gt;= len $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; len $VV##3596##k_ &gt;= len $lq_anf$##7205759403792829029##d9dr##k_
                        &amp;&amp; len v &gt;= 0
                        &amp;&amp; len $VV##3596##k_ &lt;= len $ds_d9an##k_
                        &amp;&amp; len $VV##3596##k_ &lt;= len $ds_d9ao##k_
                        &amp;&amp; len $VV##3596##k_ &lt;= len $ds_d9ar##k_
                        &amp;&amp; len $VV##3596##k_ &lt;= len $lq_anf$##7205759403792829027##d9dp##k_
                        &amp;&amp; len $VV##3596##k_ &lt;= len $lq_anf$##7205759403792829029##d9dr##k_
                        &amp;&amp; len $VV##3596##k_ &lt;= len $lq_anf$##7205759403792829030##d9ds##k_
                        &amp;&amp; len $VV##3596##k_ &lt;= len $lq_anf$##7205759403792829031##d9dt##k_}</span><span class='hs-varid'>s</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>[[GHC.Types.Char]]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"y"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Y"</span></a><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>[[GHC.Types.Char]]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"e"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"E"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | len v == 0} | VV == []}</span><span class='hs-str'>""</span></a><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>[[GHC.Types.Char]]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"s"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"S"</span></a><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span><span class='hs-definition'>quicksort</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>101: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
{VV##849 : [{VV : a | false}]&lt;\_ VV -&gt; {VV : a | false}&gt; | false} -&gt; {VV##856 : [a] | false}</span><span class='hs-definition'>quicksort</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | len v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>102: </span><span class='hs-definition'>quicksort</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | false}</span><span class='hs-varid'>smallSorted</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{v : [a] | head v == x##a8Wq}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{v : [a] | false}</span><span class='hs-varid'>bigSorted</span></a>
<span class=hs-linenum>103: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>104: </span>    <a class=annot href="#"><span class=annottext>{VV##856 : [a] | false}</span><span class='hs-varid'>smallSorted</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
{VV##849 : [{VV : a | false}]&lt;\_ VV -&gt; {VV : a | false}&gt; | false} -&gt; {VV##856 : [a] | false}</span><span class='hs-varid'>quicksort</span></a> <a class=annot href="#"><span class=annottext>{v : [{VV : a | false}]&lt;\_ VV -&gt; {VV : a | false}&gt; | false}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>a</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{v : [{VV : a | false}]&lt;\_ VV -&gt; {VV : a | false}&gt; | v == xs##a8Wr
                                                     &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>a</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>105: </span>    <a class=annot href="#"><span class=annottext>{VV##856 : [a] | false}</span><span class='hs-varid'>bigSorted</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
{VV##849 : [{VV : a | false}]&lt;\_ VV -&gt; {VV : a | false}&gt; | false} -&gt; {VV##856 : [a] | false}</span><span class='hs-varid'>quicksort</span></a> <a class=annot href="#"><span class=annottext>{v : [{VV : a | false}]&lt;\_ VV -&gt; {VV : a | false}&gt; | false}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>a</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{v : [{VV : a | false}]&lt;\_ VV -&gt; {VV : a | false}&gt; | v == xs##a8Wr
                                                     &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>a</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>106: </span>
<span class=hs-linenum>107: </span><span class='hs-comment'>-- showMat :: Matrix Digit -&gt; String</span>
<span class=hs-linenum>108: </span><span class='hs-comment'>-- showMat xs = concat [dot x | x &lt;- xs]</span>
<span class=hs-linenum>109: </span><span class='hs-comment'>--   where</span>
<span class=hs-linenum>110: </span><span class='hs-comment'>--     dot n = [if b == ' ' || b == ',' then '.' else b | b &lt;- n]</span>
<span class=hs-linenum>111: </span>
<span class=hs-linenum>112: </span>
<span class=hs-linenum>113: </span>
<span class=hs-linenum>114: </span><span class='hs-comment'>-- (1) Create a list of integers s1 ≥ s2 ≥ . . . ≥ sk = 1, where s1 is chosen uniformly at</span>
<span class=hs-linenum>115: </span><span class='hs-comment'>-- random in [1, N] and if si has been chosen and si &gt; 1, then si+1 is chosen uniformly</span>
<span class=hs-linenum>116: </span><span class='hs-comment'>-- at random in [1, si</span>
<span class=hs-linenum>117: </span><span class='hs-comment'>-- ]. Call this list S. After choosing 1, go to Step 2.</span>
<span class=hs-linenum>118: </span><span class='hs-comment'>-- (2) Let r be the product of the prime elements of S.</span>
<span class=hs-linenum>119: </span><span class='hs-comment'>-- (3) If r &gt; N, return to Step 1. Otherwise, output r, along with its prime factorization,</span>
<span class=hs-linenum>120: </span><span class='hs-comment'>-- with probability r/N. If you did not output r, return to Step 1.</span>
<span class=hs-linenum>121: </span>
<span class=hs-linenum>122: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>mkStartRndIoIntLstn1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>123: </span><span class='hs-definition'>mkStartRndIoIntLstn1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>124: </span><span class='hs-comment'>--mkStartRndIoIntLstn1 n =  sequence $ filterIndexed myPred [x | y &lt;- reverse [1 .. n], x &lt;- trace ("DEBUG: y " ++ show y) [getRndMInt (1, y)]]</span>
<span class=hs-linenum>125: </span><span class='hs-comment'>--mkStartRndIoIntLstn1 n = sequence [x | y &lt;- reverse [1 .. n], x &lt;- trace ("DEBUG: y " ++ show y) [getRndMInt (1, y)] ]</span>
<span class=hs-linenum>126: </span><span class='hs-definition'>mkStartRndIoIntLstn1</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sequence</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>reverse</span> <span class='hs-keyglyph'>[</span><span class='hs-num'>1</span> <span class='hs-keyglyph'>..</span> <span class='hs-varid'>n</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>Right</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>trace</span> <span class='hs-layout'>(</span><span class='hs-str'>"DEBUG: y "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>filterOut</span> <span class='hs-varid'>n</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>127: </span>
<span class=hs-linenum>128: </span>
<span class=hs-linenum>129: </span>
<span class=hs-linenum>130: </span><span class='hs-definition'>buildGrid</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>131: </span><a class=annot href="#"><span class=annottext>forall a . (GHC.Num.Num&lt;[]&gt; a) =&gt; [a] -&gt; [a] -&gt; [[(a, a)]]</span><span class='hs-definition'>buildGrid</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | len v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>132: </span><span class='hs-definition'>buildGrid</span> <span class='hs-layout'>(</span><span class='hs-varid'>r</span> <span class='hs-conop'>:</span> <span class='hs-varid'>rs</span><span class='hs-layout'>)</span> <span class='hs-varid'>cs</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[(a, a)]</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : (a, a) | fst v == r##a8Wz
              &amp;&amp; x_Tuple21 v == r##a8Wz}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == r##a8Wz}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>c</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{v : [a] | len v &gt;= 0}</span><span class='hs-varid'>cs</span></a><span class='hs-keyglyph'>]</span> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>[[(a, a)]]</span><span class='hs-varid'>buildGrid</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == rs##a8WA
           &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>rs</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | len v &gt;= 0}</span><span class='hs-varid'>cs</span></a>
<span class=hs-linenum>133: </span>
<span class=hs-linenum>134: </span>
<span class=hs-linenum>135: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>filterOut</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>136: </span><span class='hs-definition'>filterOut</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Either</span> <span class='hs-conid'>Text</span> <span class='hs-layout'>(</span><span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>137: </span><span class='hs-definition'>filterOut</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>i</span><span class='hs-varop'>==</span><span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Left</span> <span class='hs-varop'>$</span> <span class='hs-varid'>pack</span> <span class='hs-str'>"itsaOne"</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Right</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getRndMInt</span> <span class='hs-layout'>(</span><span class='hs-num'>1</span><span class='hs-layout'>,</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<span class=hs-linenum>138: </span>
<span class=hs-linenum>139: </span>
<span class=hs-linenum>140: </span>
<span class=hs-linenum>141: </span>
<span class=hs-linenum>142: </span>
<span class=hs-linenum>143: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>indexedPairs</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>144: </span><span class='hs-definition'>indexedPairs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>145: </span><span class='hs-definition'>indexedPairs</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>zip</span> <span class='hs-layout'>(</span><span class='hs-varid'>tail</span> <span class='hs-varop'>$</span> <span class='hs-varid'>indexedR</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>indexedR</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>146: </span>
<span class=hs-linenum>147: </span><span class='hs-definition'>indexedR</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>148: </span><a class=annot href="#"><span class=annottext>forall a . [a] -&gt; [(GHC.Types.Int, a)]</span><span class='hs-definition'>indexedR</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, a) -&gt; (GHC.Types.Int, a)</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>(GHC.Types.Int, a)</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>indx</span><span class='hs-layout'>,</span> <span class='hs-varid'>val</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; {v : (a, b)&lt;\x5 VV -&gt; {VV : b&lt;p2 x5&gt; | true}&gt; | fst v == x1
                                                                                           &amp;&amp; snd v == x2
                                                                                           &amp;&amp; x_Tuple21 v == x1
                                                                                           &amp;&amp; x_Tuple22 v == x2} | VV == (,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len xs##a8WF
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs##a8WF
           &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == indx##a8WG}</span><span class='hs-varid'>indx</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == val##a8WH}</span><span class='hs-varid'>val</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>[(GHC.Types.Int, a)]</span><span class='hs-varid'>indexed</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs##a8WF
           &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>149: </span>    
<span class=hs-linenum>150: </span><span class='hs-definition'>filterIndexed</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>151: </span><a class=annot href="#"><span class=annottext>forall a . (GHC.Types.Int -&gt; a -&gt; GHC.Types.Bool) -&gt; [a] -&gt; [a]</span><span class='hs-definition'>filterIndexed</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; a -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><a class=annot href="#"><span class=annottext>{VV : a | VV == x##a8WL}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>|</span><span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-layout'>,</span><span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>[(GHC.Types.Int, a)]</span><span class='hs-varid'>indexed</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs##a8WJ
           &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i##a8WK}</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x##a8WL}</span><span class='hs-varid'>x</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>152: </span>
<span class=hs-linenum>153: </span><span class='hs-definition'>myPred</span>  <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>154: </span><a class=annot href="#"><span class=annottext>((GHC.Types.Int, GHC.Types.Int), (GHC.Types.Int, GHC.Types.Int)) -&gt; GHC.Types.Bool</span><span class='hs-definition'>myPred</span></a> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>ia</span><span class='hs-layout'>,</span> <span class='hs-varid'>va</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>ip</span><span class='hs-layout'>,</span> <span class='hs-varid'>vp</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>155: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == ip##a8WO}</span><span class='hs-varid'>ip</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum>156: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum>157: </span>
<span class=hs-linenum>158: </span><a class=annot href="#"><span class=annottext>forall a . (GHC.Classes.Eq&lt;[]&gt; a) =&gt; a -&gt; a -&gt; [a] -&gt; [a]</span><span class='hs-definition'>replaceFirst</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>elem</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span> <span class='hs-conop'>:</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>([a], [a])&lt;\x4 VV -&gt; {v : [a] | len xs##a8WS == len x4 + len v}&gt;</span><span class='hs-varid'>break</span></a> <a class=annot href="#"><span class=annottext>v_B2:a -&gt; {v : GHC.Types.Bool | v &lt;=&gt; v_B2 == y##a8WR}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>x1:a -&gt; x2:a -&gt; {v : GHC.Types.Bool | v &lt;=&gt; x1 == x2}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == y##a8WR}</span><span class='hs-varid'>y</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs##a8WS
           &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == l##a8WT
           &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>l</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{v : [a] | head v == elem##a8WQ}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == elem##a8WQ}</span><span class='hs-varid'>elem</span></a><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == r##a8WU
           &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>r</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs##a8WS
           &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>159: </span>
<span class=hs-linenum>160: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>replaceFirst'</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>161: </span><span class='hs-definition'>replaceFirst'</span> <span class='hs-varid'>elem</span> <span class='hs-varid'>y</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>162: </span>  <span class='hs-keyglyph'>[</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>163: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span> <span class='hs-conop'>:</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>break</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>164: </span>          <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>165: </span>            <span class='hs-keyword'>if</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>null</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<span class=hs-linenum>166: </span>              <span class='hs-keyword'>then</span> <span class='hs-varid'>l</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>elem</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <span class='hs-varid'>r</span>
<span class=hs-linenum>167: </span>              <span class='hs-keyword'>else</span> <span class='hs-varid'>l</span>
<span class=hs-linenum>168: </span>      <span class='hs-comment'>--a &lt;- c</span>
<span class=hs-linenum>169: </span>  <span class='hs-keyglyph'>]</span>
<span class=hs-linenum>170: </span>
<span class=hs-linenum>171: </span>  
<span class=hs-linenum>172: </span>
<span class=hs-linenum>173: </span><span class='hs-comment'>-- -- | Maze cells are identified by integers</span>
<span class=hs-linenum>174: </span><span class='hs-comment'>-- type Cell = Int</span>
<span class=hs-linenum>175: </span>
<span class=hs-linenum>176: </span><span class='hs-comment'>-- -- | A maze is a map from cells to adjacent cells</span>
<span class=hs-linenum>177: </span><span class='hs-comment'>-- type Maze = Cell -&gt; [Cell]</span>
<span class=hs-linenum>178: </span>
<span class=hs-linenum>179: </span><span class='hs-comment'>-- maze :: Maze</span>
<span class=hs-linenum>180: </span><span class='hs-comment'>-- maze =</span>
<span class=hs-linenum>181: </span><span class='hs-comment'>--   ( [ [1],</span>
<span class=hs-linenum>182: </span><span class='hs-comment'>--       [0, 2, 5],</span>
<span class=hs-linenum>183: </span><span class='hs-comment'>--       [1, 3],</span>
<span class=hs-linenum>184: </span><span class='hs-comment'>--       [2],</span>
<span class=hs-linenum>185: </span><span class='hs-comment'>--       [5],</span>
<span class=hs-linenum>186: </span><span class='hs-comment'>--       [4, 6, 1, 9],</span>
<span class=hs-linenum>187: </span><span class='hs-comment'>--       [5, 7],</span>
<span class=hs-linenum>188: </span><span class='hs-comment'>--       [6, 11],</span>
<span class=hs-linenum>189: </span><span class='hs-comment'>--       [12],</span>
<span class=hs-linenum>190: </span><span class='hs-comment'>--       [5, 13],</span>
<span class=hs-linenum>191: </span><span class='hs-comment'>--       [9],</span>
<span class=hs-linenum>192: </span><span class='hs-comment'>--       [7, 15],</span>
<span class=hs-linenum>193: </span><span class='hs-comment'>--       [8, 16],</span>
<span class=hs-linenum>194: </span><span class='hs-comment'>--       [14, 9, 17],</span>
<span class=hs-linenum>195: </span><span class='hs-comment'>--       [13, 15],</span>
<span class=hs-linenum>196: </span><span class='hs-comment'>--       [14, 11],</span>
<span class=hs-linenum>197: </span><span class='hs-comment'>--       [12, 17],</span>
<span class=hs-linenum>198: </span><span class='hs-comment'>--       [13, 16, 18],</span>
<span class=hs-linenum>199: </span><span class='hs-comment'>--       [17, 19],</span>
<span class=hs-linenum>200: </span><span class='hs-comment'>--       [18]</span>
<span class=hs-linenum>201: </span><span class='hs-comment'>--     ]</span>
<span class=hs-linenum>202: </span><span class='hs-comment'>--       !!</span>
<span class=hs-linenum>203: </span><span class='hs-comment'>--   )</span>
<span class=hs-linenum>204: </span>
<span class=hs-linenum>205: </span><span class='hs-comment'>-- {-@ ignore solve @-}</span>
<span class=hs-linenum>206: </span>
<span class=hs-linenum>207: </span><span class='hs-comment'>-- -- | Find paths from the given start to the end</span>
<span class=hs-linenum>208: </span><span class='hs-comment'>-- solve :: Maze -&gt; Cell -&gt; Cell -&gt; [[Cell]]</span>
<span class=hs-linenum>209: </span><span class='hs-comment'>-- solve maze start = solve' []</span>
<span class=hs-linenum>210: </span><span class='hs-comment'>--   where</span>
<span class=hs-linenum>211: </span><span class='hs-comment'>--     -- solve' :: [Cell] -&gt; Cell -&gt; [[Cell]]</span>
<span class=hs-linenum>212: </span><span class='hs-comment'>--     solve' path end =</span>
<span class=hs-linenum>213: </span><span class='hs-comment'>--       let path' = end : path</span>
<span class=hs-linenum>214: </span><span class='hs-comment'>--        in if start == end</span>
<span class=hs-linenum>215: </span><span class='hs-comment'>--             then return path'</span>
<span class=hs-linenum>216: </span><span class='hs-comment'>--             else -- else do</span>
<span class=hs-linenum>217: </span><span class='hs-comment'>--             --     neighbor &lt;- maze end</span>
<span class=hs-linenum>218: </span><span class='hs-comment'>--             --     guard (neighbor `notElem` path)</span>
<span class=hs-linenum>219: </span><span class='hs-comment'>--             --     solve' path' neighbor</span>
<span class=hs-linenum>220: </span>
<span class=hs-linenum>221: </span><span class='hs-comment'>--               [result | neighbor &lt;- maze end, neighbor `notElem` path, result &lt;- solve' path' neighbor]</span>
<span class=hs-linenum>222: </span>
<span class=hs-linenum>223: </span><span class='hs-comment'>-- randomBool :: Int -&gt; IO Bool</span>
<span class=hs-linenum>224: </span><span class='hs-comment'>-- randomBool p = do</span>
<span class=hs-linenum>225: </span><span class='hs-comment'>--   n &lt;- randomRIO (1, 100)</span>
<span class=hs-linenum>226: </span><span class='hs-comment'>--   pure (n &gt; p)</span>
<span class=hs-linenum>227: </span>
<span class=hs-linenum>228: </span><span class='hs-comment'>-- -- isActionRandom :: Float -&gt; Int -&gt; Int -&gt; Int -&gt; IO [Bool]</span>
<span class=hs-linenum>229: </span><span class='hs-comment'>-- -- isActionRandom eps n m step = sequence $ [randomBool (floor (eps - (0.01 * fromIntegral y) * 100))</span>
<span class=hs-linenum>230: </span><span class='hs-comment'>-- --                             | x &lt;- [1..(n*m)]</span>
<span class=hs-linenum>231: </span><span class='hs-comment'>-- --                             , y &lt;- [floor (fromIntegral x / (fromIntegral (m * step)))]]</span>
</pre>
</body>
</html>