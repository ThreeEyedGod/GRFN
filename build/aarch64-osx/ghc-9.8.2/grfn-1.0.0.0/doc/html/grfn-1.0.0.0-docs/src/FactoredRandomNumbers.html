<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE UnicodeSyntax #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">{--
   The Adam Kalai Algorithm implmemented in this module (see Readme for more details)
              Input: Integer n &gt; 0.

              Output: A uniformly random number 1 &#8804; r &#8804; n.

                  1. Generate a sequence n &#8805; s1 &#8805; s2 &#8805; &#183;&#183;&#183; &#8805; sl = 1 by choosing
                  s1 &#8712; {1, 2,..., n} and si+1 &#8712; {1, 2,...,si}, until reaching 1.
                  2. Let r be the product of the prime si&#8217;s.
                  3. If r &#8804; n, output r with probability r/n.
                  4. Otherwise, RESTART.
--}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="annot"><span class="hs-comment">-- | Module for accessing functions based on Kalai's Algorithm</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">FactoredRandomNumbers</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="FactoredRandomNumbers.html#genARandomPreFactoredNumberLTEn"><span class="hs-identifier">genARandomPreFactoredNumberLTEn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSize"><span class="hs-identifier">preFactoredNumOfBitSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizePar"><span class="hs-identifier">preFactoredNumOfBitSizePar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.Async</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">race</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.ParallelIO.Local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">parallelFirst</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withPool</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Loops</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">iterateWhile</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Parallel.Strategies</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parBuffer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parListChunk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parListSplitAt</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rdeepseq</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rpar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withStrategy</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Unamb</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">race</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Conc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getNumCapabilities</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getNumProcessors</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setNumCapabilities</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Math.NumberTheory.Primes.Testing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bailliePSW</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- isPrime is slower</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Protolude</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pure</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-identifier">Bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">False</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-identifier">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-identifier">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(==)</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-identifier">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">maximum</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-identifier">IO</span></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-identifier">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-identifier">Integer</span></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-identifier">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Just</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="hs-identifier">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&gt;&gt;=)</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-identifier">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(+)</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-identifier">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">max</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">min</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&gt;)</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-identifier">abs</span></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-identifier">div</span></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-identifier">flip</span></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-identifier">fst</span></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-identifier">length</span></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-identifier">maximum</span></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-identifier">odd</span></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-identifier">otherwise</span></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-identifier">product</span></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-identifier">replicate</span></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-identifier">snd</span></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-operator">($)</span></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-operator">(&amp;&amp;)</span></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="hs-operator">(.)</span></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-operator">(&lt;$&gt;)</span></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="hs-operator">(&lt;*&gt;)</span></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="hs-operator">(^)</span></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-operator">(||)</span></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.Stateful</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">globalStdGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">uniformRM</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><span class="hs-comment">-- | Strategies that may be used with parallel calls</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">data</span><span> </span><span id="Strats"><span class="annot"><a href="FactoredRandomNumbers.html#Strats"><span class="hs-identifier hs-var">Strats</span></a></span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Chunk"><span class="annot"><a href="FactoredRandomNumbers.html#Chunk"><span class="hs-identifier hs-var">Chunk</span></a></span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Buffer"><span class="annot"><a href="FactoredRandomNumbers.html#Buffer"><span class="hs-identifier hs-var">Buffer</span></a></span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Split"><span class="annot"><a href="FactoredRandomNumbers.html#Split"><span class="hs-identifier hs-var">Split</span></a></span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067796"><span id="local-6989586621679067798"><span class="annot"><span class="annottext">Strats -&gt; Strats -&gt; Bool
(Strats -&gt; Strats -&gt; Bool)
-&gt; (Strats -&gt; Strats -&gt; Bool) -&gt; Eq Strats
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Strats -&gt; Strats -&gt; Bool
== :: Strats -&gt; Strats -&gt; Bool
$c/= :: Strats -&gt; Strats -&gt; Bool
/= :: Strats -&gt; Strats -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | Takes an Integer for Bitsize value to operate on range [2 ^ y, 2 ^ y + 1 - 1].  This function leverages parallel execution</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- Provide an integer input and it should generate a tuple of a number in the range [2^y, 2^y+1 -1] and its prime factors</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- In the event that the concurrent call fails, a recovery through a basic parallelised call is attempted.</span><span>
</span><span id="line-82"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizePar"><span class="hs-identifier hs-type">preFactoredNumOfBitSizePar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="preFactoredNumOfBitSizePar"><span class="annot"><span class="annottext">preFactoredNumOfBitSizePar :: Integer -&gt; IO (Either Text (Integer, [Integer]))
</span><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizePar"><span class="hs-identifier hs-var hs-var">preFactoredNumOfBitSizePar</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; IO (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer]) -&gt; Either Text (Integer, [Integer])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizePar"><span class="hs-identifier hs-var">preFactoredNumOfBitSizePar</span></a></span><span> </span><span id="local-6989586621679067802"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067802"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067802"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; Maybe (Either Text (Integer, [Integer]))
-&gt; Either Text (Integer, [Integer])
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; Maybe (Either Text (Integer, [Integer]))
 -&gt; Either Text (Integer, [Integer]))
-&gt; IO (Either Text (Integer, [Integer]))
-&gt; IO
     (Maybe (Either Text (Integer, [Integer]))
      -&gt; Either Text (Integer, [Integer]))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (Either Text (Integer, [Integer]))
</span><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSize"><span class="hs-identifier hs-var">preFactoredNumOfBitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067802"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">IO
  (Maybe (Either Text (Integer, [Integer]))
   -&gt; Either Text (Integer, [Integer]))
-&gt; IO (Maybe (Either Text (Integer, [Integer])))
-&gt; IO (Either Text (Integer, [Integer]))
forall a b. IO (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (Maybe (Either Text (Integer, [Integer])))
</span><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizeParMaybe"><span class="hs-identifier hs-var">preFactoredNumOfBitSizeParMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067802"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-85"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizePar"><span class="hs-identifier hs-var">preFactoredNumOfBitSizePar</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; IO (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text (Integer, [Integer])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text (Integer, [Integer]))
-&gt; Text -&gt; Either Text (Integer, [Integer])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid&quot;</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Parallel preFactored Number given BitSize</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- Provide an integer input. Generate a tuple of a number in the range [2^y, 2^y+1 -1] and its prime factors.</span><span>
</span><span id="line-89"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizeParMaybe"><span class="hs-identifier hs-type">preFactoredNumOfBitSizeParMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span id="preFactoredNumOfBitSizeParMaybe"><span class="annot"><span class="annottext">preFactoredNumOfBitSizeParMaybe :: Integer -&gt; IO (Maybe (Either Text (Integer, [Integer])))
</span><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizeParMaybe"><span class="hs-identifier hs-var hs-var">preFactoredNumOfBitSizeParMaybe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either Text (Integer, [Integer]))
-&gt; IO (Maybe (Either Text (Integer, [Integer])))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either Text (Integer, [Integer]))
 -&gt; IO (Maybe (Either Text (Integer, [Integer]))))
-&gt; Maybe (Either Text (Integer, [Integer]))
-&gt; IO (Maybe (Either Text (Integer, [Integer])))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; Maybe (Either Text (Integer, [Integer]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; Maybe (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; Maybe (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer]) -&gt; Either Text (Integer, [Integer])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizeParMaybe"><span class="hs-identifier hs-var">preFactoredNumOfBitSizeParMaybe</span></a></span><span> </span><span id="local-6989586621679067804"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067804"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067804"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067804"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; Maybe (Either Text (Integer, [Integer]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; Maybe (Either Text (Integer, [Integer])))
-&gt; IO (Either Text (Integer, [Integer]))
-&gt; IO (Maybe (Either Text (Integer, [Integer])))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (Either Text (Integer, [Integer]))
</span><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSize"><span class="hs-identifier hs-var">preFactoredNumOfBitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067804"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizeParMaybe"><span class="hs-identifier hs-var">preFactoredNumOfBitSizeParMaybe</span></a></span><span> </span><span id="local-6989586621679067805"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067805"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067805"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; IO (Int, Int) -&gt; IO Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Int, Int)
</span><a href="FactoredRandomNumbers.html#coresToUse"><span class="hs-identifier hs-var">coresToUse</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO Int
-&gt; (Int -&gt; IO (Maybe (Either Text (Integer, [Integer]))))
-&gt; IO (Maybe (Either Text (Integer, [Integer])))
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">IO (Either Text (Integer, [Integer]))
-&gt; Int -&gt; IO (Maybe (Either Text (Integer, [Integer])))
forall a. IO a -&gt; Int -&gt; IO (Maybe a)
</span><a href="FactoredRandomNumbers.html#spinUpThreads"><span class="hs-identifier hs-var">spinUpThreads</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; IO (Either Text (Integer, [Integer]))
</span><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSize"><span class="hs-identifier hs-var">preFactoredNumOfBitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067805"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSizeParMaybe"><span class="hs-identifier hs-var">preFactoredNumOfBitSizeParMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either Text (Integer, [Integer]))
-&gt; IO (Maybe (Either Text (Integer, [Integer])))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either Text (Integer, [Integer]))
 -&gt; IO (Maybe (Either Text (Integer, [Integer]))))
-&gt; Maybe (Either Text (Integer, [Integer]))
-&gt; IO (Maybe (Either Text (Integer, [Integer])))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; Maybe (Either Text (Integer, [Integer]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; Maybe (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; Maybe (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text (Integer, [Integer])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text (Integer, [Integer]))
-&gt; Text -&gt; Either Text (Integer, [Integer])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid&quot;</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><span class="hs-comment">-- | Spin up t threads of function f in parallel and return the one which completes first</span></span><span>
</span><span id="line-96"></span><span id="local-6989586621679067583"><span class="annot"><a href="FactoredRandomNumbers.html#spinUpThreads"><span class="hs-identifier hs-type">spinUpThreads</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679067583"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679067583"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-97"></span><span id="spinUpThreads"><span class="annot"><span class="annottext">spinUpThreads :: forall a. IO a -&gt; Int -&gt; IO (Maybe a)
</span><a href="FactoredRandomNumbers.html#spinUpThreads"><span class="hs-identifier hs-var hs-var">spinUpThreads</span></a></span></span><span> </span><span id="local-6989586621679067809"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067809"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679067810"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067810"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Pool -&gt; IO (Maybe a)) -&gt; IO (Maybe a)
forall a. Int -&gt; (Pool -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withPool</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067810"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((Pool -&gt; IO (Maybe a)) -&gt; IO (Maybe a))
-&gt; (Pool -&gt; IO (Maybe a)) -&gt; IO (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679067811"><span class="annot"><span class="annottext">Pool
</span><a href="#local-6989586621679067811"><span class="hs-identifier hs-var">pool</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pool -&gt; [IO (Maybe a)] -&gt; IO (Maybe a)
forall a. Pool -&gt; [IO (Maybe a)] -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">parallelFirst</span></span><span> </span><span class="annot"><span class="annottext">Pool
</span><a href="#local-6989586621679067811"><span class="hs-identifier hs-var">pool</span></a></span><span> </span><span class="annot"><span class="annottext">([IO (Maybe a)] -&gt; IO (Maybe a)) -&gt; [IO (Maybe a)] -&gt; IO (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Maybe a) -&gt; [IO (Maybe a)]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067810"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; IO a -&gt; IO (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067809"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Spin up t actions of function f in parallel and return what's executed first</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- for now ignore t; fires up a 2 horse 'race' call from Control.Concurrent.Async</span><span>
</span><span id="line-101"></span><span id="local-6989586621679067812"><span class="annot"><a href="FactoredRandomNumbers.html#_spinUpActions"><span class="hs-identifier hs-type">_spinUpActions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679067812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679067812"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-102"></span><span id="_spinUpActions"><span class="annot"><span class="annottext">_spinUpActions :: forall a. IO a -&gt; Int -&gt; IO (Maybe a)
</span><a href="FactoredRandomNumbers.html#_spinUpActions"><span class="hs-identifier hs-var hs-var">_spinUpActions</span></a></span></span><span> </span><span id="local-6989586621679067814"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067814"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (Maybe a)
forall a. IO a -&gt; IO (Maybe a)
</span><a href="FactoredRandomNumbers.html#_raceJust"><span class="hs-identifier hs-var">_raceJust</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067814"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Spin up t Forks of function f in parallel and return what's executed first</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- for now ignore the second paramemter; fires up a 2-horse 'race' call from Data.Unamb</span><span>
</span><span id="line-106"></span><span id="local-6989586621679067816"><span class="annot"><a href="FactoredRandomNumbers.html#_spinUpForks"><span class="hs-identifier hs-type">_spinUpForks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679067816"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679067816"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-107"></span><span id="_spinUpForks"><span class="annot"><span class="annottext">_spinUpForks :: forall a. IO a -&gt; Int -&gt; IO (Maybe a)
</span><a href="FactoredRandomNumbers.html#_spinUpForks"><span class="hs-identifier hs-var hs-var">_spinUpForks</span></a></span></span><span> </span><span id="local-6989586621679067818"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067818"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (Maybe a)
forall a. IO a -&gt; IO (Maybe a)
</span><a href="FactoredRandomNumbers.html#_raceJustU"><span class="hs-identifier hs-var">_raceJustU</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067818"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><span class="hs-comment">-- | Convert async.race from Either-Or to Maybe</span></span><span>
</span><span id="line-110"></span><span id="local-6989586621679067590"><span class="annot"><a href="FactoredRandomNumbers.html#_raceJust"><span class="hs-identifier hs-type">_raceJust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679067590"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679067590"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-111"></span><span id="_raceJust"><span class="annot"><span class="annottext">_raceJust :: forall a. IO a -&gt; IO (Maybe a)
</span><a href="FactoredRandomNumbers.html#_raceJust"><span class="hs-identifier hs-var hs-var">_raceJust</span></a></span></span><span> </span><span id="local-6989586621679067823"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067823"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">IO a -&gt; IO a -&gt; IO (Either a a)
forall a b. IO a -&gt; IO b -&gt; IO (Either a b)
</span><span class="hs-identifier hs-var">race</span></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067823"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067823"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either a a) -&gt; (Either a a -&gt; IO (Maybe a)) -&gt; IO (Maybe a)
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679067824"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067824"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; IO (Maybe a)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; IO (Maybe a)) -&gt; Maybe a -&gt; IO (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067824"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679067825"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067825"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; IO (Maybe a)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; IO (Maybe a)) -&gt; Maybe a -&gt; IO (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067825"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><span class="hs-comment">-- | Convert Data.Unamb.race to Maybe</span></span><span>
</span><span id="line-117"></span><span id="local-6989586621679067826"><span class="annot"><a href="FactoredRandomNumbers.html#_raceJustU"><span class="hs-identifier hs-type">_raceJustU</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679067826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679067826"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-118"></span><span id="_raceJustU"><span class="annot"><span class="annottext">_raceJustU :: forall a. IO a -&gt; IO (Maybe a)
</span><a href="FactoredRandomNumbers.html#_raceJustU"><span class="hs-identifier hs-var hs-var">_raceJustU</span></a></span></span><span> </span><span id="local-6989586621679067828"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067828"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; IO a -&gt; IO (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO a -&gt; IO a
forall a. IO a -&gt; IO a -&gt; IO a
</span><span class="hs-identifier hs-var">Data.Unamb.race</span></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067828"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679067828"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><span class="hs-comment">-- | Figure out # cores to use for parallelization</span></span><span>
</span><span id="line-121"></span><span class="annot"><a href="FactoredRandomNumbers.html#coresToUse"><span class="hs-identifier hs-type">coresToUse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span id="coresToUse"><span class="annot"><span class="annottext">coresToUse :: IO (Int, Int)
</span><a href="FactoredRandomNumbers.html#coresToUse"><span class="hs-identifier hs-var hs-var">coresToUse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679067829"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067829"><span class="hs-identifier hs-var">nCores</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Int
</span><span class="hs-identifier hs-var">getNumProcessors</span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679067832"><span class="annot"><span class="annottext">nEfficiencyCores :: Int
</span><a href="#local-6989586621679067832"><span class="hs-identifier hs-var hs-var">nEfficiencyCores</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067829"><span class="hs-identifier hs-var">nCores</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-comment">-- a heuristic : 50% of cores = efficiency</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679067833"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067833"><span class="hs-identifier hs-var">nNumCapabilities</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Int
</span><span class="hs-identifier hs-var">getNumCapabilities</span></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">setNumCapabilities</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; IO ()) -&gt; Int -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067829"><span class="hs-identifier hs-var">nCores</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067832"><span class="hs-identifier hs-var">nEfficiencyCores</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067833"><span class="hs-identifier hs-var">nNumCapabilities</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679067834"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067834"><span class="hs-identifier hs-var">nNumCapabilitiesSet</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Int
</span><span class="hs-identifier hs-var">getNumCapabilities</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><span class="annottext">(Int, Int) -&gt; IO (Int, Int)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067829"><span class="hs-identifier hs-var">nCores</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067834"><span class="hs-identifier hs-var">nNumCapabilitiesSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | Takes an Integer as a Bitsize value to operate on range [2 ^ y, 2 ^ y + 1 - 1]</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- Provide an integer input and it should generate a tuple of a number in the range [2^y, 2^y+1 -1] and its prime factors.</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- if it throws up a value below 2^n then do again. 50% of the time it should result in success.</span><span>
</span><span id="line-133"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSize"><span class="hs-identifier hs-type">preFactoredNumOfBitSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span id="preFactoredNumOfBitSize"><span class="annot"><span class="annottext">preFactoredNumOfBitSize :: Integer -&gt; IO (Either Text (Integer, [Integer]))
</span><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSize"><span class="hs-identifier hs-var hs-var">preFactoredNumOfBitSize</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; IO (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer]) -&gt; Either Text (Integer, [Integer])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSize"><span class="hs-identifier hs-var">preFactoredNumOfBitSize</span></a></span><span> </span><span id="local-6989586621679067835"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067835"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067835"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer]) -&gt; Bool)
-&gt; IO (Either Text (Integer, [Integer]))
-&gt; IO (Either Text (Integer, [Integer]))
forall (m :: * -&gt; *) a. Monad m =&gt; (a -&gt; Bool) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">iterateWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067835"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Either Text (Integer, [Integer]) -&gt; Bool
</span><a href="FactoredRandomNumbers.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; IO (Either Text (Integer, [Integer]))
</span><a href="FactoredRandomNumbers.html#genARandomPreFactoredNumberLTEn"><span class="hs-identifier hs-var">genARandomPreFactoredNumberLTEn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067835"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="annot"><a href="FactoredRandomNumbers.html#preFactoredNumOfBitSize"><span class="hs-identifier hs-var">preFactoredNumOfBitSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; IO (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text (Integer, [Integer])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text (Integer, [Integer]))
-&gt; Text -&gt; Either Text (Integer, [Integer])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid&quot;</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="FactoredRandomNumbers.html#%3C%7C"><span class="hs-operator hs-type">&lt;|</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><span class="hs-comment">-- | An operator to compare the Right first value of the (Int, [Int]) to an Int for Truth-value of lesser-than predicate</span></span><span>
</span><span id="line-141"></span><span class="annot"><a href="FactoredRandomNumbers.html#%3C%7C"><span class="hs-operator hs-type">(&lt;|)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-142"></span><span id="local-6989586621679067837"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067837"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span id="%3C%7C"><span class="annot"><span class="annottext">&lt;| :: Integer -&gt; Either Text (Integer, [Integer]) -&gt; Bool
</span><a href="FactoredRandomNumbers.html#%3C%7C"><span class="hs-operator hs-var hs-var">&lt;|</span></a></span></span><span> </span><span id="local-6989586621679067838"><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
</span><a href="#local-6989586621679067838"><span class="hs-identifier hs-var">eOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
</span><a href="#local-6989586621679067838"><span class="hs-identifier hs-var">eOR</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679067839"><span class="annot"><span class="annottext">(Integer, [Integer])
</span><a href="#local-6989586621679067839"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer]) -&gt; Integer
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer])
</span><a href="#local-6989586621679067839"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067837"><span class="hs-identifier hs-var">bound</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | This is the Entry Function with a Integer bound. This is the core of the Kalai algorithm</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- Provide an integer input and it should generate a tuple of a number less than the input integer and its prime factors</span><span>
</span><span id="line-148"></span><span class="annot"><a href="FactoredRandomNumbers.html#genARandomPreFactoredNumberLTEn"><span class="hs-identifier hs-type">genARandomPreFactoredNumberLTEn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span id="genARandomPreFactoredNumberLTEn"><span class="annot"><span class="annottext">genARandomPreFactoredNumberLTEn :: Integer -&gt; IO (Either Text (Integer, [Integer]))
</span><a href="FactoredRandomNumbers.html#genARandomPreFactoredNumberLTEn"><span class="hs-identifier hs-var hs-var">genARandomPreFactoredNumberLTEn</span></a></span></span><span> </span><span id="local-6989586621679067840"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067840"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067840"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; IO (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text (Integer, [Integer])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either Text (Integer, [Integer]))
-&gt; Text -&gt; Either Text (Integer, [Integer])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid&quot;</span></span><span>
</span><span id="line-150"></span><span class="annot"><a href="FactoredRandomNumbers.html#genARandomPreFactoredNumberLTEn"><span class="hs-identifier hs-var">genARandomPreFactoredNumberLTEn</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; IO (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer]) -&gt; Either Text (Integer, [Integer])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="annot"><a href="FactoredRandomNumbers.html#genARandomPreFactoredNumberLTEn"><span class="hs-identifier hs-var">genARandomPreFactoredNumberLTEn</span></a></span><span> </span><span id="local-6989586621679067841"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067841"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621679067842"><span class="annot"><span class="annottext">(Integer, [Integer])
</span><a href="#local-6989586621679067842"><span class="hs-identifier hs-var">candidateTuple</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO (Integer, [Integer])
</span><a href="FactoredRandomNumbers.html#potentialResult"><span class="hs-identifier hs-var">potentialResult</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067841"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; IO (Either Text (Integer, [Integer]))
-&gt; IO (Either Text (Integer, [Integer]))
-&gt; IO (Either Text (Integer, [Integer]))
forall b. Bool -&gt; b -&gt; b -&gt; b
</span><a href="FactoredRandomNumbers.html#if%27"><span class="hs-identifier hs-var">if'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer, [Integer]) -&gt; Integer
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Integer, [Integer]) -&gt; Integer)
-&gt; (Integer -&gt; Bool) -&gt; (Integer, [Integer]) -&gt; Bool
forall a b. (a -&gt; b) -&gt; (b -&gt; Bool) -&gt; a -&gt; Bool
</span><a href="FactoredRandomNumbers.html#is"><span class="hs-operator hs-var">`is`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067841"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer])
</span><a href="#local-6989586621679067842"><span class="hs-identifier hs-var">candidateTuple</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Text (Integer, [Integer])
 -&gt; IO (Either Text (Integer, [Integer])))
-&gt; Either Text (Integer, [Integer])
-&gt; IO (Either Text (Integer, [Integer]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer]) -&gt; Either Text (Integer, [Integer])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer])
</span><a href="#local-6989586621679067842"><span class="hs-identifier hs-var">candidateTuple</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; IO (Either Text (Integer, [Integer]))
</span><a href="FactoredRandomNumbers.html#genARandomPreFactoredNumberLTEn"><span class="hs-identifier hs-var">genARandomPreFactoredNumberLTEn</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067841"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- else keep doing till success</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- | Provided an Integer List, throws up a candidate Int and its prime factors for further assessment</span></span><span>
</span><span id="line-156"></span><span class="annot"><a href="FactoredRandomNumbers.html#filterPrimesProduct"><span class="hs-identifier hs-type">filterPrimesProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span id="filterPrimesProduct"><span class="annot"><span class="annottext">filterPrimesProduct :: [Integer] -&gt; (Integer, [Integer])
</span><a href="FactoredRandomNumbers.html#filterPrimesProduct"><span class="hs-identifier hs-var hs-var">filterPrimesProduct</span></a></span></span><span> </span><span id="local-6989586621679067847"><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067847"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, [Integer])
</span><a href="#local-6989586621679067848"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679067848"><span class="annot"><span class="annottext">result :: (Integer, [Integer])
</span><a href="#local-6989586621679067848"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067851"><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067851"><span class="hs-identifier hs-var">sq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (f :: * -&gt; *) a. (Foldable f, Num a) =&gt; f a -&gt; a
</span><span class="hs-identifier hs-var">product</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067851"><span class="hs-identifier hs-var">sq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; [Integer]
</span><a href="FactoredRandomNumbers.html#onlyPrimesFrom"><span class="hs-identifier hs-var">onlyPrimesFrom</span></a></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067847"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- note: product [] = 1</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><span class="hs-comment">-- | parallel filter with 3 optional strategies</span></span><span>
</span><span id="line-160"></span><span id="local-6989586621679067608"><span class="annot"><a href="FactoredRandomNumbers.html#parFilter"><span class="hs-identifier hs-type">parFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679067608"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FactoredRandomNumbers.html#Strats"><span class="hs-identifier hs-type">Strats</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067608"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067608"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067608"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-161"></span><span id="parFilter"><span class="annot"><span class="annottext">parFilter :: forall a. NFData a =&gt; Strats -&gt; Int -&gt; (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="FactoredRandomNumbers.html#parFilter"><span class="hs-identifier hs-var hs-var">parFilter</span></a></span></span><span> </span><span id="local-6989586621679067859"><span class="annot"><span class="annottext">Strats
</span><a href="#local-6989586621679067859"><span class="hs-identifier hs-var">strat</span></a></span></span><span> </span><span id="local-6989586621679067860"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067860"><span class="hs-identifier hs-var">stratParm</span></a></span></span><span> </span><span id="local-6989586621679067861"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679067861"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Strats
</span><a href="#local-6989586621679067859"><span class="hs-identifier hs-var">strat</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><span class="annottext">Strats
</span><a href="FactoredRandomNumbers.html#Chunk"><span class="hs-identifier hs-var">Chunk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Strategy [a] -&gt; [a] -&gt; [a]
forall a. Strategy a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">withStrategy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Strategy a -&gt; Strategy [a]
forall a. Int -&gt; Strategy a -&gt; Strategy [a]
</span><span class="hs-identifier hs-var">parListChunk</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067860"><span class="hs-identifier hs-var">stratParm</span></a></span><span> </span><span class="annot"><span class="annottext">Strategy a
forall a. NFData a =&gt; Strategy a
</span><span class="hs-identifier hs-var">rdeepseq</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679067861"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><span class="annottext">Strats
</span><a href="FactoredRandomNumbers.html#Buffer"><span class="hs-identifier hs-var">Buffer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Strategy [a] -&gt; [a] -&gt; [a]
forall a. Strategy a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">withStrategy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Strategy a -&gt; Strategy [a]
forall a. Int -&gt; Strategy a -&gt; Strategy [a]
</span><span class="hs-identifier hs-var">parBuffer</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067860"><span class="hs-identifier hs-var">stratParm</span></a></span><span> </span><span class="annot"><span class="annottext">Strategy a
forall a. Strategy a
</span><span class="hs-identifier hs-var">rpar</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679067861"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="annottext">Strats
</span><a href="FactoredRandomNumbers.html#Split"><span class="hs-identifier hs-var">Split</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Strategy [a] -&gt; [a] -&gt; [a]
forall a. Strategy a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">withStrategy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Strategy [a] -&gt; Strategy [a] -&gt; Strategy [a]
forall a. Int -&gt; Strategy [a] -&gt; Strategy [a] -&gt; Strategy [a]
</span><span class="hs-identifier hs-var">parListSplitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067860"><span class="hs-identifier hs-var">stratParm</span></a></span><span> </span><span class="annot"><span class="annottext">Strategy [a]
forall a. NFData a =&gt; Strategy a
</span><span class="hs-identifier hs-var">rdeepseq</span></span><span> </span><span class="annot"><span class="annottext">Strategy [a]
forall a. NFData a =&gt; Strategy a
</span><span class="hs-identifier hs-var">rdeepseq</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679067861"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Reduction of a composite list of integers into primefactors</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- Select the parallel (or not) strategy based on the size range. Use Parallel &gt; Billion</span><span>
</span><span id="line-168"></span><span class="annot"><a href="FactoredRandomNumbers.html#onlyPrimesFrom"><span class="hs-identifier hs-type">onlyPrimesFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span id="onlyPrimesFrom"><span class="annot"><span class="annottext">onlyPrimesFrom :: [Integer] -&gt; [Integer]
</span><a href="FactoredRandomNumbers.html#onlyPrimesFrom"><span class="hs-identifier hs-var hs-var">onlyPrimesFrom</span></a></span></span><span> </span><span id="local-6989586621679067862"><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067862"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067862"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Bool) -&gt; [Integer] -&gt; [Integer]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="FactoredRandomNumbers.html#isPrimeOr1"><span class="hs-identifier hs-var">isPrimeOr1</span></a></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067862"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-comment">-- at a billion try parallelzing and concurrency options</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Strats -&gt; Int -&gt; (Integer -&gt; Bool) -&gt; [Integer] -&gt; [Integer]
forall a. NFData a =&gt; Strats -&gt; Int -&gt; (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="FactoredRandomNumbers.html#parFilter"><span class="hs-identifier hs-var">parFilter</span></a></span><span> </span><span class="annot"><span class="annottext">Strats
</span><a href="FactoredRandomNumbers.html#Split"><span class="hs-identifier hs-var">Split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Integer] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067862"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="FactoredRandomNumbers.html#isPrimeOr1"><span class="hs-identifier hs-var">isPrimeOr1</span></a></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679067862"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- assuming the first 3rd of the list comprise larger numbers and their processing workload = the residual 2/3rd</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><span class="hs-comment">-- | Provided an Integer, throws up a candidate Int and its factors for further evaluation</span></span><span>
</span><span id="line-176"></span><span class="annot"><a href="FactoredRandomNumbers.html#potentialResult"><span class="hs-identifier hs-type">potentialResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="potentialResult"><span class="annot"><span class="annottext">potentialResult :: Integer -&gt; IO (Integer, [Integer])
</span><a href="FactoredRandomNumbers.html#potentialResult"><span class="hs-identifier hs-var hs-var">potentialResult</span></a></span></span><span> </span><span id="local-6989586621679067864"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067864"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO [Integer]
</span><a href="FactoredRandomNumbers.html#mkList"><span class="hs-identifier hs-var">mkList</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067864"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">IO [Integer]
-&gt; ([Integer] -&gt; (Integer, [Integer])) -&gt; IO (Integer, [Integer])
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; (Integer, [Integer])
</span><a href="FactoredRandomNumbers.html#filterPrimesProduct"><span class="hs-identifier hs-var">filterPrimesProduct</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Provided an Integer, creates a sequence of random integers LTE n in decreasing order,</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- possibly with multiples ending at 1</span><span>
</span><span id="line-181"></span><span class="annot"><a href="FactoredRandomNumbers.html#mkList"><span class="hs-identifier hs-type">mkList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span id="mkList"><span class="annot"><span class="annottext">mkList :: Integer -&gt; IO [Integer]
</span><a href="FactoredRandomNumbers.html#mkList"><span class="hs-identifier hs-var hs-var">mkList</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; IO [Integer]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span class="annot"><a href="FactoredRandomNumbers.html#mkList"><span class="hs-identifier hs-var">mkList</span></a></span><span> </span><span id="local-6989586621679067866"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067866"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; IO Integer
</span><a href="FactoredRandomNumbers.html#getRndMInt"><span class="hs-identifier hs-var">getRndMInt</span></a></span><span> </span><span class="annot"><span class="annottext">((Integer, Integer) -&gt; IO Integer)
-&gt; (Integer -&gt; IO [Integer]) -&gt; (Integer, Integer) -&gt; IO [Integer]
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m [b]) -&gt; a -&gt; m [b]
</span><a href="FactoredRandomNumbers.html#%3E%3D%3E%3A"><span class="hs-operator hs-var">&gt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO [Integer]
</span><a href="FactoredRandomNumbers.html#mkList"><span class="hs-identifier hs-var">mkList</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067866"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><span class="hs-comment">-- | Get a Random Integer with uniform probability in the range (l,u)</span></span><span>
</span><span id="line-186"></span><span class="annot"><a href="FactoredRandomNumbers.html#getRndMInt"><span class="hs-identifier hs-type">getRndMInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-187"></span><span id="getRndMInt"><span class="annot"><span class="annottext">getRndMInt :: (Integer, Integer) -&gt; IO Integer
</span><a href="FactoredRandomNumbers.html#getRndMInt"><span class="hs-identifier hs-var hs-var">getRndMInt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067869"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067869"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067870"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067870"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067869"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; (Integer -&gt; Integer) -&gt; Integer -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067870"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; IO Integer -&gt; IO Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; AtomicGenM StdGen -&gt; IO Integer
forall a g (m :: * -&gt; *).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
(Integer, Integer) -&gt; g -&gt; m Integer
</span><span class="hs-identifier hs-var">uniformRM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067869"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067870"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AtomicGenM StdGen
</span><span class="hs-identifier hs-var">globalStdGen</span></span><span> </span><span class="hs-comment">-- uniformRM (a, b) = uniformRM (b, a) holds as per fn defn</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="FactoredRandomNumbers.html#%3E%3D%3E%3A"><span class="hs-operator hs-type">&gt;=&gt;:</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Left-to-right Kleisli composition of monads plus prepend elem to List using applicative</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- Late edit: there may be something in Control.arrow that already does exactly this</span><span>
</span><span id="line-193"></span><span id="local-6989586621679067627"><span id="local-6989586621679067628"><span id="local-6989586621679067629"><span class="annot"><a href="FactoredRandomNumbers.html#%3E%3D%3E%3A"><span class="hs-operator hs-type">(&gt;=&gt;:)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679067627"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067628"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067627"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067629"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067629"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067627"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067629"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067628"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067627"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067629"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-194"></span><span id="local-6989586621679067878"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679067878"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="%3E%3D%3E%3A"><span class="annot"><span class="annottext">&gt;=&gt;: :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m [b]) -&gt; a -&gt; m [b]
</span><a href="FactoredRandomNumbers.html#%3E%3D%3E%3A"><span class="hs-operator hs-var hs-var">&gt;=&gt;:</span></a></span></span><span> </span><span id="local-6989586621679067879"><span class="annot"><span class="annottext">b -&gt; m [b]
</span><a href="#local-6989586621679067879"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679067878"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m b) -&gt; (b -&gt; m [b]) -&gt; a -&gt; m [b]
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679067880"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067880"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067880"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b]) -&gt; m [b] -&gt; m [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; m [b]
</span><a href="#local-6989586621679067879"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067880"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | True if input is prime or 1</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- Primality testing is one key to peformance of this algo</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- the isOdd and greater than 3 is for the use of bailliePSW primality</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- using bailliePSW in place of the standard isPrime leads to 75% reduction in time !!!</span><span>
</span><span id="line-200"></span><span class="annot"><a href="FactoredRandomNumbers.html#isPrimeOr1"><span class="hs-identifier hs-type">isPrimeOr1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-201"></span><span id="isPrimeOr1"><span class="annot"><span class="annottext">isPrimeOr1 :: Integer -&gt; Bool
</span><a href="FactoredRandomNumbers.html#isPrimeOr1"><span class="hs-identifier hs-var hs-var">isPrimeOr1</span></a></span></span><span> </span><span id="local-6989586621679067881"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067881"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067882"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067882"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067882"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">odd</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067882"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><span class="hs-identifier hs-var">bailliePSW</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067882"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679067882"><span class="annot"><span class="annottext">i :: Integer
</span><a href="#local-6989586621679067882"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067881"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-comment">-- bailliePSW requires that n &gt; 3 and that input is Odd</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><span class="hs-comment">-- | from Data.Function.predicate</span></span><span>
</span><span id="line-204"></span><span id="local-6989586621679067604"><span id="local-6989586621679067605"><span class="annot"><a href="FactoredRandomNumbers.html#is"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067604"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067605"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067605"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067604"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-205"></span><span id="is"><span class="annot"><span class="annottext">is :: forall a b. (a -&gt; b) -&gt; (b -&gt; Bool) -&gt; a -&gt; Bool
</span><a href="FactoredRandomNumbers.html#is"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((b -&gt; Bool) -&gt; (a -&gt; b) -&gt; a -&gt; Bool)
-&gt; (a -&gt; b) -&gt; (b -&gt; Bool) -&gt; a -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Bool) -&gt; (a -&gt; b) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><span class="hs-comment">-- | @if then else@ made concise</span></span><span>
</span><span id="line-208"></span><span id="local-6989586621679067603"><span class="annot"><a href="FactoredRandomNumbers.html#if%27"><span class="hs-identifier hs-type">if'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067603"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067603"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067603"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-209"></span><span id="if%27"><span class="annot"><span class="annottext">if' :: forall b. Bool -&gt; b -&gt; b -&gt; b
</span><a href="FactoredRandomNumbers.html#if%27"><span class="hs-identifier hs-var hs-var">if'</span></a></span></span><span> </span><span id="local-6989586621679067884"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067884"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679067885"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067885"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679067886"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067886"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067884"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067885"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067886"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-212"></span></pre></body></html>